<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>jimpex</title><meta name="description" content="Documentation for jimpex"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">jimpex</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>jimpex</h1></div><div class="tsd-panel tsd-typography"><a id="md:jimpex" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Jimpex<a href="#md:jimpex" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p><a href="https://github.com/homer0/jimpex/actions/workflows/test.yml?query=branch%3Amain" target="_blank" class="external"><img src="https://img.shields.io/github/actions/workflow/status/homer0/jimpex/test.yml?branch=main&amp;style=flat-square" alt="GitHub Workflow Status (main)"></a>
<a href="https://coveralls.io/github/homer0/jimpex?branch=main" target="_blank" class="external"><img src="https://img.shields.io/coveralls/github/homer0/jimpex.svg?style=flat-square" alt="Coveralls GitHub"></a>
<img src="https://img.shields.io/librariesio/release/npm/jimpex?style=flat-square" alt="Libraries.io dependency status for latest release"></p>
<p>Express as dependency injection container.</p>
<p>Jimpex is an implementation of <a href="https://expressjs.com" target="_blank" class="external">Express</a>, one of the most popular web frameworks for Node, using <a href="https://github.com/fjorgemota/jimple" target="_blank" class="external">Jimple</a>, a Javascript port of <a href="https://github.com/silexphp/Pimple" target="_blank" class="external">Pimple</a> dependency injection container.</p>
<blockquote>
<p>⚠️ If you want to upgrade to v8, please read the <a href="https://github.com/homer0/jimpex/blob/main/documents/migration-v8.md" target="_blank" class="external">migration guide</a>.</p>
</blockquote>
<ul>
<li><a href="#md:%F0%9F%8D%BF-usage">🍿 Usage</a>
<ul>
<li><a href="#md:%F0%9F%8E%A8-creating-your-app">🎨 Creating your app</a></li>
<li><a href="#md:%F0%9F%A4%96-boot">🤖 Boot</a></li>
<li><a href="#md:%E2%9A%99%EF%B8%8F-options-and-configuration">⚙️ Options and configuration</a>
<ul>
<li><a href="#md:options">Options</a></li>
<li><a href="#md:configuration">Configuration</a></li>
</ul>
</li>
<li><a href="#md:%F0%9F%9A%80-starting-the-app">🚀 Starting your app</a></li>
<li><a href="#md:%E2%9C%85-https">✅ HTTPS</a>
<ul>
<li><a href="#md:http2">HTTP2</a></li>
</ul>
</li>
<li><a href="#md:%F0%9F%9B%A0-services">🛠 Services</a>
<ul>
<li><a href="#md:configurable-services">Configurable services</a></li>
</ul>
</li>
<li><a href="#md:%F0%9F%9A%A6-controller">🚦 Controllers</a>
<ul>
<li><a href="#md:configurable-controllers">Configurable controllers</a></li>
<li><a href="#md:controllers-with-services">Controllers with services</a></li>
</ul>
</li>
<li><a href="#md:%E2%9A%A1%EF%B8%8F-middlewares">⚡️ Middlewares</a>
<ul>
<li><a href="#md:configurable-middlewares">Configurable middlewares</a></li>
<li><a href="#md:middlewares-with-services">Middlewares with services</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#md:%F0%9F%92%AA-typescript">💪 TypeScript</a></li>
<li><a href="#md:%F0%9F%A4%9E-examples">🤞 Examples</a></li>
<li><a href="#md:development">🤘 Development</a>
<ul>
<li><a href="#md:npm-scripts">NPM scripts</a></li>
<li><a href="#md:repository-hooks">Repository hooks</a></li>
<li><a href="#md:commits-conventions">Commits conventions</a></li>
<li><a href="#md:releases">Releases</a></li>
<li><a href="#md:testing">Testing</a></li>
<li><a href="#md:code-linting-and-formatting">Code linting and formatting</a></li>
<li><a href="#md:documentation">Documentation</a></li>
</ul>
</li>
<li><a href="#md:%F0%9F%91%80-motivation">👀 Motivation</a></li>
</ul>
<a id="md:🍿-usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">🍿 Usage<a href="#md:🍿-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:🎨-creating-your-app" class="tsd-anchor"></a><h3 class="tsd-anchor-link">🎨 Creating your app<a href="#md:🎨-creating-your-app" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">app</span><span class="hl-1"> = </span><span class="hl-6">jimpex</span><span class="hl-1">();</span><br/><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><span class="hl-3">&#39;something&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">Something</span><span class="hl-1">());</span><br/><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">mount</span><span class="hl-1">(</span><span class="hl-3">&#39;/hello&#39;</span><span class="hl-1">, (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">send</span><span class="hl-1">(</span><span class="hl-3">&#39;Hello World!&#39;</span><span class="hl-1">));</span><br/><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">listen</span><span class="hl-1">(</span><span class="hl-7">2509</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&#39;The app is running!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>That's all: you create the app, register/set your dependencies, and mount your routes.</p>
<p>Alternatively, you could import the class, subclass it, and make use of the &quot;life cycle&quot; methods to configure it:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">boot</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><span class="hl-3">&#39;something&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">Something</span><span class="hl-1">());</span><br/><span class="hl-1">    </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">mount</span><span class="hl-1">(</span><span class="hl-3">&#39;/hello&#39;</span><span class="hl-1">, (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">send</span><span class="hl-1">(</span><span class="hl-3">&#39;Hello World!&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">app</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">MyApp</span><span class="hl-1">();</span><br/><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">listen</span><span class="hl-1">(</span><span class="hl-7">2509</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&#39;The app is running!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:🤖-boot" class="tsd-anchor"></a><h3 class="tsd-anchor-link">🤖 Boot<a href="#md:🤖-boot" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>boot</code> method gets called right from the constructor, when the <code>boot</code> option is set to <code>true</code> (its default value), and the idea is for you to use it to add all your customizations (as seen in the example above).</p>
<p>Like <code>boot</code>, there's another &quot;helper method&quot; that you can use to register your dependencies: <code>_init</code>; the difference is that <code>_init</code> gets called from the constructor before the <code>boot</code> options gets validated. This allows you to create scenarios in which you could register some resources on <code>_init</code>, disable the call to <code>boot</code>, overwrite what you set on <code>_init</code>, and manually call <code>boot</code>:</p>
<pre><code class="ts"><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">_init</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><span class="hl-3">&#39;message&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Hello Charo!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-6">boot</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">mount</span><span class="hl-1">(</span><span class="hl-3">&#39;/hello&#39;</span><span class="hl-1">, (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">send</span><span class="hl-1">(</span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;message&#39;</span><span class="hl-1">)));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">app</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">MyApp</span><span class="hl-1">({ </span><span class="hl-2">boot:</span><span class="hl-1"> </span><span class="hl-4">false</span><span class="hl-1"> });</span><br/><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><span class="hl-3">&#39;message&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Hello Pili!&#39;</span><span class="hl-1">);</span><br/><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">boot</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<p>Now, this may look like an unnecessary feature, but if you consider the possiblity of different entry points based on environment, maybe to enable debugging tools on dev, this becomes really useful.</p>
<a id="md:⚙️-options-and-configuration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">⚙️ Options and configuration<a href="#md:⚙️-options-and-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>On Jimpex, you have two sets of &quot;settings&quot;: the options, which are in the code when you create the application; and the configuration, which may be related to the environment in which the application is running.</p>
<a id="md:options" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Options<a href="#md:options" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>You can read all about the different options in <a href="https://github.com/homer0/jimpex/blob/main/documents/options.md" target="_blank" class="external">its own documentation</a>, but they're more related to the application capabilities. For example:</p>
<ul>
<li>Whether or not to call <code>boot</code>.</li>
<li>Whether or not Express should remove the <code>x-powered-by</code> header.</li>
<li>Which env var to check for the environment configuration (you'll see more about this in a sec).</li>
</ul>
<p>And depending on how you defined your application, you have two ways to customize the options.</p>
<p>First, if you used the function, you can just send them as a parameter:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">app</span><span class="hl-1"> = </span><span class="hl-6">jimpex</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">boot:</span><span class="hl-1"> </span><span class="hl-4">false</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">express:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">disableXPoweredBy:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">config:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">environmentVariable:</span><span class="hl-1"> </span><span class="hl-3">&#39;NODE_ENV&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>And yes, you could also use this approach with the class, as both the function and the class constructor share the same parameters, but if you want to already define your options inside your subclass, there's a <em>protected</em> helper for it: <code>_initOptions</code>.</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">_initOptions</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">boot:</span><span class="hl-1"> </span><span class="hl-4">false</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">express:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">disableXPoweredBy:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-2">config:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">environmentVariable:</span><span class="hl-1"> </span><span class="hl-3">&#39;NODE_ENV&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>The advantage of <code>_initOptions</code> is not only that you don't need to overwrite the constructor, but that you can still receive the options from the constructor, and Jimpex will automatically deep merge the ones on <code>_initOptions</code> on top of them.</p>
<a id="md:configuration" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Configuration<a href="#md:configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>These are the settings that are more related to the runtime, and that can change depending on the environment. The most basic example of a &quot;configuration setting&quot; would be the port in which the application runs: you could run it on local env in 3000, and on production in 80 (or 443).</p>
<p>While the configuration is more easily managed with external (config) files, you could also send it in the options:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">app</span><span class="hl-1"> = </span><span class="hl-6">jimpex</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">config:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">default:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">port:</span><span class="hl-1"> </span><span class="hl-7">3000</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-9">// or</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">app2</span><span class="hl-1"> = </span><span class="hl-6">jimpex</span><span class="hl-1">(</span><br/><span class="hl-1">  { </span><span class="hl-2">someOption:</span><span class="hl-1"> </span><span class="hl-4">false</span><span class="hl-1"> },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-2">port:</span><span class="hl-1"> </span><span class="hl-7">3000</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>You can use the option <code>config.default</code>, or just the second parameter of both the function and the class.</p>
<blockquote>
<p>⚠️ If you don't configure the <code>port</code> and call <code>start()</code>, the application will throw an error.</p>
</blockquote>
<p>That's the basic usage, but as mentioned before, the configuration is more easily managed with external files: when loading the configuration, which happens when the server starts, it will try to look for a file <code>config/app.config.js</code>, and if it exists, it will set whatever it (default) exports as the configuration.</p>
<p>So, we could write the configuration from the example above and use it like this:</p>
<pre><code class="ts"><span class="hl-9">// config/app.config.js</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">port:</span><span class="hl-1"> </span><span class="hl-7">3000</span><span class="hl-1">,</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-9">// src/index.js</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">app</span><span class="hl-1"> = </span><span class="hl-6">jimpex</span><span class="hl-1">();</span><br/><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<p>Now, the really great feature about the config files, is that you could extend them and manage which one gets loaded depending on the environment: When loading the configuration, Jimpex will check the value of the environment variable <code>CONFIG</code> and try to load a config file <code>config/app.config.${CONFIG}.js</code>. For example:</p>
<p>You could have the default configuration with the port set to <code>3000</code>, and a &quot;staging&quot; configuration with the port set to <code>80</code>.</p>
<pre><code class="ts"><span class="hl-9">// config/app.config.js</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">port:</span><span class="hl-1"> </span><span class="hl-7">3000</span><span class="hl-1">,</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-9">// config/app.config.staging.js</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">port:</span><span class="hl-1"> </span><span class="hl-7">80</span><span class="hl-1">,</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<p>And if <code>CONFIG</code> is set to <code>staging</code> when the application starts, the staging configuration will be loaded.</p>
<p>Finally, you can access the configuration settings with the <code>config</code> service:</p>
<pre><code class="ts"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">port</span><span class="hl-1"> = </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;config&#39;</span><span class="hl-1">).</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;port&#39;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<blockquote>
<p>You can read more about the options for the configuration service in the <a href="https://github.com/homer0/jimpex/blob/main/documents/options.md" target="_blank" class="external">options documentation</a>, but it's basically an implementation of <a href="https://www.npmjs.com/package/@homer0/simple-config" target="_blank" class="external"><code>@homer0/simple-config</code></a>.</p>
</blockquote>
<a id="md:🚀-starting-the-app" class="tsd-anchor"></a><h3 class="tsd-anchor-link">🚀 Starting the app<a href="#md:🚀-starting-the-app" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="js"><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">listen</span><span class="hl-1">(</span><span class="hl-7">2509</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&#39;The app is running!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Just like any other Node server, you can use the <code>listen</code> method and specify a port and a callback.</p>
<p>Now, if you you already have a <code>port</code> set on the configuration, you could use the <code>start</code> method; it works just like listen but it only receives a callback:</p>
<pre><code class="js"><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">(() </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&#39;The app is running!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>And finally, you can also stop the application by calling...</p>
<pre><code class="js"><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">stop</span><span class="hl-1">();</span><br/><span class="hl-9">// Done, the app is not longer running.</span>
</code><button type="button">Copy</button></pre>

<a id="md:✅-https" class="tsd-anchor"></a><h3 class="tsd-anchor-link">✅ HTTPS<a href="#md:✅-https" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>HTTPS is enabled via configuration, not options, just like the application port:</p>
<pre><code class="ts"><span class="hl-9">// config/app.config.js</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">port:</span><span class="hl-1"> </span><span class="hl-7">2509</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">https:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">enabled:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">credentials:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">cert:</span><span class="hl-1"> </span><span class="hl-3">&#39;...cert-file&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">key:</span><span class="hl-1"> </span><span class="hl-3">&#39;...key-file&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<p>By default, Jimpex will look for those files relative to the project root directory, but you can change so it will look on a path relative to the directory where the application executable is located by setting <code>https.credentials.onHome</code> to <code>false</code>.</p>
<a id="md:http2" class="tsd-anchor"></a><h4 class="tsd-anchor-link">HTTP2<a href="#md:http2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>To enable <a href="https://en.wikipedia.org/wiki/HTTP/2" target="_blank" class="external">HTTP/2</a>, you MUST enable HTTPS first, and then just add a flag in the configuration:</p>
<pre><code class="ts"><span class="hl-9">// config/app.config.js</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">port:</span><span class="hl-1"> </span><span class="hl-7">2509</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">https:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">enabled:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">credentials:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">cert:</span><span class="hl-1"> </span><span class="hl-3">&#39;...cert-file&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">key:</span><span class="hl-1"> </span><span class="hl-3">&#39;...key-file&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">http2:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">enabled:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<p>Under the hood, Jimpex uses <a href="https://npmjs.com/package/spdy" target="_blank" class="external">Spdy</a> for the HTTP/2 support, and Spdy has custom options you can send in order to define how it will work; you can send options to Spdy by adding a <code>spdy</code> key inside the <code>http2</code> object:</p>
<pre><code class="ts"><span class="hl-9">// config/app.config.js</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">port:</span><span class="hl-1"> </span><span class="hl-7">2509</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">https:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">enabled:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">credentials:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">cert:</span><span class="hl-1"> </span><span class="hl-3">&#39;...cert-file&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">key:</span><span class="hl-1"> </span><span class="hl-3">&#39;...key-file&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">http2:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">enabled:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">spdy:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">&#39;x-forwarded-for&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-3">&#39;127.0.0.1&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<a id="md:🛠-services" class="tsd-anchor"></a><h3 class="tsd-anchor-link">🛠 Services<a href="#md:🛠-services" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This is the most-core functionality that Jimple, and Jimpex, provide. You can easily create providers for services/resources that you want to use in your application:</p>
<pre><code class="ts"><span class="hl-9">// src/my-service.js</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">provider</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyService</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">constructor</span><span class="hl-1">(</span><span class="hl-2">config</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-2">config</span><span class="hl-1"> = </span><span class="hl-2">config</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-6">getMeThePort</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-2">config</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;port&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">myService</span><span class="hl-1"> = </span><span class="hl-6">provider</span><span class="hl-1">((</span><span class="hl-2">app</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><span class="hl-3">&#39;myService&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">MyService</span><span class="hl-1">(</span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;config&#39;</span><span class="hl-1">)));</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<blockquote>
<p>You could just export the provider, but I believe is a good practice to export both, in case another part of your app wants to extend the class and overwrite the service on the container.</p>
</blockquote>
<p>The, on the app, you would simple <code>register</code> the provider:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">myService</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./my-service&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">boot</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">register</span><span class="hl-1">(</span><span class="hl-2">myService</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Done, your service is now available in the container.</p>
<p>Jimpex already comes with a few built-in service providers ready to be used, and you can read about them on the <a href="https://github.com/homer0/jimpex/blob/main/documents/services.md" target="_blank" class="external">services document</a>.</p>
<a id="md:configurable-services" class="tsd-anchor"></a><h5 class="tsd-anchor-link">Configurable services<a href="#md:configurable-services" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h5><p>Since the version of Jimple that Jimpex uses under the hood is <a href="https://www.npmjs.com/package/@homer0/jimple" target="_blank" class="external"><code>@homer0/jimple</code></a>, my custom &quot;fork&quot;, you can also create &quot;configureable providers&quot;:</p>
<pre><code class="ts"><span class="hl-9">// src/my-service.js</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">providerCreator</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyService</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">constructor</span><span class="hl-1">(</span><span class="hl-2">config</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-2">config</span><span class="hl-1"> = </span><span class="hl-2">config</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-6">getMeThePort</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-2">config</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;port&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">myService</span><span class="hl-1"> = </span><span class="hl-6">providerCreator</span><span class="hl-1">((</span><span class="hl-2">options</span><span class="hl-1"> = {}) </span><span class="hl-4">=&gt;</span><span class="hl-1"> (</span><span class="hl-2">app</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-5">serviceName</span><span class="hl-1"> = </span><span class="hl-3">&#39;myService&#39;</span><span class="hl-1"> } = </span><span class="hl-2">options</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><span class="hl-2">serviceName</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">MyService</span><span class="hl-1">(</span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;config&#39;</span><span class="hl-1">)));</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>If you are thinking this is just a HOF, you are wrong. The &quot;magic&quot; of the creator version is that it can be used as a provider and/or as a function:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">myService</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./my-service&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">boot</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">register</span><span class="hl-1">(</span><span class="hl-2">myService</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">register</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-6">myService</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-2">serviceName:</span><span class="hl-1"> </span><span class="hl-3">&#39;myService2&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      }),</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Check the README of <a href="https://www.npmjs.com/package/@homer0/jimple" target="_blank" class="external"><code>@homer0/jimple</code></a> for more information about providers.</p>
<a id="md:🚦-controllers" class="tsd-anchor"></a><h3 class="tsd-anchor-link">🚦 Controllers<a href="#md:🚦-controllers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>To define a controller, you just need to use the <code>controller</code> wrapper (like <code>provider</code>), modify a router, and return it:</p>
<pre><code class="ts"><span class="hl-9">// src/health-controller.js</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">controller</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-9">// (Optional) Define a class to organize your route handlers.</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">HealthController</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">health</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">&#39;Everything works!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">();</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-9">// Define the controller</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">healthController</span><span class="hl-1"> = </span><span class="hl-6">controller</span><span class="hl-1">((</span><span class="hl-2">app</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">ctrl</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">HealthController</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-9">// Get an instance of the router service</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">router</span><span class="hl-1"> = </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;router&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-9">// Return the router with all the routes</span><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">router</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">, </span><span class="hl-2">ctrl</span><span class="hl-1">.</span><span class="hl-6">health</span><span class="hl-1">()).</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;/health&#39;</span><span class="hl-1">, (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">&#39;Everything works!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<blockquote>
<ol>
<li>You could just export the controller, but I believe is a good practice to export both, in case another part of your app wants to extend the class and mount a new route with its inherited functionalities.</li>
<li>In case you are wondering about the lazy loading of the services that you may inject, the function inside the <code>controller</code> wrapper won't be called until the app is started.</li>
</ol>
</blockquote>
<p>Then, on you app, you would <code>mount</code> the controller:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">healthController</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./health-controller&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">boot</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">mount</span><span class="hl-1">(</span><span class="hl-3">&#39;/health&#39;</span><span class="hl-1">, </span><span class="hl-2">healthController</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Jimpex already comes with a few built-in controllers ready to be used, and you can read about them on the <a href="https://github.com/homer0/jimpex/blob/main/documents/controllers.md" target="_blank" class="external">controllers document</a>.</p>
<a id="md:configurable-controllers" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Configurable controllers<a href="#md:configurable-controllers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>The same as with the services, you can define controllers that accept custom options for the moment they are mounted:</p>
<pre><code class="ts"><span class="hl-9">// src/health-controller.js</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">controllerCreator</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-9">// (Optional) Define a class to organize your route handlers.</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">HealthController</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">health</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">&#39;Everything works!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">();</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-9">// Define the controller</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">healthController</span><span class="hl-1"> = </span><span class="hl-6">controllerCreator</span><span class="hl-1">((</span><span class="hl-2">options</span><span class="hl-1"> = {}) </span><span class="hl-4">=&gt;</span><span class="hl-1"> (</span><span class="hl-2">app</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">ctrl</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">HealthController</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-9">// Get an instance of the router service</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">router</span><span class="hl-1"> = </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;router&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-9">// Read the custom options</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-5">altRoute</span><span class="hl-1"> = </span><span class="hl-3">&#39;/health&#39;</span><span class="hl-1"> } = </span><span class="hl-2">options</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-9">// Return the router with all the routes</span><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">router</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">, </span><span class="hl-2">ctrl</span><span class="hl-1">.</span><span class="hl-6">health</span><span class="hl-1">()).</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-2">altRoute</span><span class="hl-1">, (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">&#39;Everything works!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>And like with the provider creators, these can be used as a controller, or as a function:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">healthController</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./health-controller&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">boot</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">mount</span><span class="hl-1">(</span><span class="hl-3">&#39;/health&#39;</span><span class="hl-1">, </span><span class="hl-2">healthController</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">mount</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-3">&#39;/hp&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">healthController</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-2">altRoute:</span><span class="hl-1"> </span><span class="hl-3">&#39;/status&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      }),</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:controllers-with-services" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Controllers with services<a href="#md:controllers-with-services" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>If for some reason, your controller needs to register a service that the rest of the container needs to have access to, and you plan to do it on the <code>controller</code>/<code>controllerCreator</code> callback, you could end up messing with the <em>lazyness</em> of the container: If a middleware or another controller tries to access the service and the controller that registers it is mounted after it, it will get an error as the service <em>doesn't exist yet</em>.</p>
<p>A way to solve this issue would be with a <code>provider</code>/<code>providerCreator</code>, mounting the controller:</p>
<pre><code class="ts"><span class="hl-9">// dont-do-this.js</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">provider</span><span class="hl-1">, </span><span class="hl-2">controller</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">wrong</span><span class="hl-1"> = </span><span class="hl-6">provider</span><span class="hl-1">((</span><span class="hl-2">app</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><span class="hl-3">&#39;wrong&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">WrongService</span><span class="hl-1">());</span><br/><span class="hl-1">  </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">mount</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">controller</span><span class="hl-1">((</span><span class="hl-2">app</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">wrong</span><span class="hl-1"> = </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;wrong&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">router</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">, </span><span class="hl-2">wrong</span><span class="hl-1">.</span><span class="hl-6">doSomething</span><span class="hl-1">());</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>The main problem with that approach is that you would have to <code>register</code> it as a provider, so the route for the controller would need to be defined inside the callback.</p>
<p>So, for this case, Jimpex has a special wrapper, which is very similar, but that it allows you to <code>mount</code> it:</p>
<pre><code class="ts"><span class="hl-9">// controller-provider.js</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">controllerProvider</span><span class="hl-1">, </span><span class="hl-2">controller</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">good</span><span class="hl-1"> = </span><span class="hl-6">controllerProvider</span><span class="hl-1">((</span><span class="hl-2">app</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><span class="hl-3">&#39;good&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">GoodService</span><span class="hl-1">());</span><br/><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-6">controller</span><span class="hl-1">((</span><span class="hl-2">app</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">good</span><span class="hl-1"> = </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;good&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">router</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">, </span><span class="hl-2">good</span><span class="hl-1">.</span><span class="hl-6">doSomething</span><span class="hl-1">());</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>The <code>controllerProvider</code> wrapper allows you to register something in the callback, and expects a wrapped <code>controller</code> to be returned. That way, you can <code>mount</code> it, and specify the root outside.</p>
<p>And like <code>provider</code>, and <code>controller</code>, there's also a <code>controllerProviderCreator</code>.</p>
<a id="md:⚡️-middlewares" class="tsd-anchor"></a><h3 class="tsd-anchor-link">⚡️ Middlewares<a href="#md:⚡️-middlewares" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>To create a new middleware, you just need to use the <code>middleware</code> wrapper and return it:</p>
<pre><code class="ts"><span class="hl-9">// my-middleware.js</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">middleware</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-9">// Define your middleware function (or class if it gets more complex)</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">greetingsMiddleware</span><span class="hl-1"> = () </span><span class="hl-4">=&gt;</span><span class="hl-1"> (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">, </span><span class="hl-2">next</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">&#39;Hello World!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">();</span><br/><span class="hl-1">  } </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">next</span><span class="hl-1">(</span><span class="hl-2">err</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-9">// Define the middleware</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">greetings</span><span class="hl-1"> = </span><span class="hl-6">middleware</span><span class="hl-1">(() </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-6">greetingsMiddleware</span><span class="hl-1">());</span>
</code><button type="button">Copy</button></pre>

<p>Then, on the app, you would <code>use</code> it:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">greetings</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./my-middleware&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">boot</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">use</span><span class="hl-1">(</span><span class="hl-2">greetings</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Now, middlewares can also be <code>mount</code>ed in specific routes:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">greetings</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./my-middleware&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">boot</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">mount</span><span class="hl-1">(</span><span class="hl-3">&#39;/greetings&#39;</span><span class="hl-1">, </span><span class="hl-2">greetings</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>And, if you don't need access to the container in the middleware definition, you could also <code>mount</code>/<code>use</code> it as a <em>raw</em> Express' middleware:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">greetingsMiddleware</span><span class="hl-1"> = (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">, </span><span class="hl-2">next</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">&#39;Hello World!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">();</span><br/><span class="hl-1">  } </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">next</span><span class="hl-1">(</span><span class="hl-2">err</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">boot</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">use</span><span class="hl-1">(</span><span class="hl-2">greetingsMiddleware</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-9">// or</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">mount</span><span class="hl-1">(</span><span class="hl-3">&#39;/greetings&#39;</span><span class="hl-1">, </span><span class="hl-2">greetingsMiddleware</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Jimpex already comes with a few built-in middlewares ready to be used, and you can read about them on the <a href="https://github.com/homer0/jimpex/blob/main/documents/middlewares.md" target="_blank" class="external">middlewares document</a>.</p>
<a id="md:configurable-middlewares" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Configurable middlewares<a href="#md:configurable-middlewares" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Just like the <code>controllerCreator</code> wrapper, you can also use the <code>middlewareCreator</code> wrapper to define middlewares that accept custom options:</p>
<pre><code class="ts"><span class="hl-9">// my-middleware.js</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">middlwareCreator</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-9">// Define your middleware function (or class if it gets more complex)</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">greetingsMiddleware</span><span class="hl-1"> = (</span><span class="hl-2">message</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">, </span><span class="hl-2">next</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-2">message</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">();</span><br/><span class="hl-1">  } </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">next</span><span class="hl-1">(</span><span class="hl-2">err</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-9">// Define the middleware</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">greetings</span><span class="hl-1"> = </span><span class="hl-6">middleware</span><span class="hl-1">((</span><span class="hl-2">options</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-5">message</span><span class="hl-1"> = </span><span class="hl-3">&#39;Hello Charo!&#39;</span><span class="hl-1"> } = </span><span class="hl-2">options</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-6">greetingsMiddleware</span><span class="hl-1">(</span><span class="hl-2">message</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>And now you can use it as a middleware, or as a function that returns a middleware:</p>
<pre><code class="ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Jimpex</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">greetings</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./my-middleware&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MyApp</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-8">Jimpex</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">boot</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">use</span><span class="hl-1">(</span><span class="hl-2">greetings</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-9">// or</span><br/><span class="hl-1">    </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-6">mount</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-3">&#39;/greetings&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">greetings</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-2">message:</span><span class="hl-1"> </span><span class="hl-3">&#39;Hello Pili!&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      }),</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:middlewares-with-services" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Middlewares with services<a href="#md:middlewares-with-services" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>If, for some reason, your middleware needs to register a service before being mounted, just like the <code>controllerProvider</code>, you have the <code>middlewareProvider</code> wrapper:</p>
<pre><code class="ts"><span class="hl-9">// middleware-provider.js</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">middlewareProvider</span><span class="hl-1">, </span><span class="hl-2">middleware</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;jimpex&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">MiddlewareService</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">getMiddleware</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> (</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">&#39;Everything works!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">();</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">middlewareService</span><span class="hl-1"> = </span><span class="hl-6">middlewareProvider</span><span class="hl-1">((</span><span class="hl-2">app</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><span class="hl-3">&#39;middlewareService&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">MiddlewareService</span><span class="hl-1">());</span><br/><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-6">middleware</span><span class="hl-1">((</span><span class="hl-2">app</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">service</span><span class="hl-1"> = </span><span class="hl-2">app</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&#39;middlewareService&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">service</span><span class="hl-1">.</span><span class="hl-6">getMiddleware</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>And finally, you also have <code>middlewareProviderCreator</code> to create a middleware that can register a service, with custom options.</p>
<a id="md:💪-typescript" class="tsd-anchor"></a><h2 class="tsd-anchor-link">💪 TypeScript<a href="#md:💪-typescript" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>After v8, Jimpex was completely rewritten in TypeScript, so you can use it with no problems in your TypeScript projects. For more information, please refer to the <a href="https://github.com/homer0/jimpex/blob/main/documents/typescript.md" target="_blank" class="external">TypeScript document</a>.</p>
<a id="md:🤞-examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">🤞 Examples<a href="#md:🤞-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>You can find the example projects in the <code>example</code> directory. To run them, you can use the <code>npm run example</code> command. By default, it runs the <code>basic</code> example, but you can also specify the name of the example you want to run:</p>
<pre><code class="bash"><span class="hl-6">npm</span><span class="hl-1"> </span><span class="hl-3">run</span><span class="hl-1"> </span><span class="hl-3">example</span><span class="hl-1"> [name-of-the-directory]</span>
</code><button type="button">Copy</button></pre>

<a id="md:🤘-development" class="tsd-anchor"></a><h2 class="tsd-anchor-link">🤘 Development<a href="#md:🤘-development" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:npm-scripts" class="tsd-anchor"></a><h3 class="tsd-anchor-link">NPM scripts<a href="#md:npm-scripts" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Script</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>build</code></td>
<td>Transpiles the TypeScript code.</td>
</tr>
<tr>
<td><code>docs</code></td>
<td>Generates the project documentation.</td>
</tr>
<tr>
<td><code>lint</code></td>
<td>Lints and formats the staged files.</td>
</tr>
<tr>
<td><code>lint:all</code></td>
<td>Lints the entire project code.</td>
</tr>
<tr>
<td><code>types:check</code></td>
<td>Validates the types definitions.</td>
</tr>
<tr>
<td><code>test</code></td>
<td>Runs the project unit tests.</td>
</tr>
<tr>
<td><code>todo</code></td>
<td>Lists all the pending to-do's.</td>
</tr>
<tr>
<td><code>example</code></td>
<td>Runs an example project.</td>
</tr>
</tbody>
</table>
<a id="md:repository-hooks" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Repository hooks<a href="#md:repository-hooks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>I use <a href="https://npmjs.com/package/husky" target="_blank" class="external"><code>husky</code></a> to automatically install the repository hooks:</p>
<table>
<thead>
<tr>
<th>Hook</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>commit-msg</code></td>
<td>Ensures the use of conventional commits.</td>
</tr>
<tr>
<td><code>pre-commit</code></td>
<td>Lints and formats the staged files.</td>
</tr>
<tr>
<td><code>pre-push</code></td>
<td>Validates the types and run the tests.</td>
</tr>
<tr>
<td><code>post-merge</code></td>
<td>Updates the dependencies (<code>npm i</code>).</td>
</tr>
</tbody>
</table>
<a id="md:commits-conventions" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Commits conventions<a href="#md:commits-conventions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>I use <a href="https://www.conventionalcommits.org" target="_blank" class="external">conventional commits</a> with <a href="https://commitlint.js.org" target="_blank" class="external"><code>commitlint</code></a> in order to support semantic releases. The one that sets it up is actually <code>husky</code>, since it installs a script that runs <code>commitlint</code> on the commit message validation.</p>
<p>The configuration is on the <code>commitlint</code> property of the <code>package.json</code>.</p>
<a id="md:releases" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Releases<a href="#md:releases" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>I use <a href="https://npmjs.com/package/semantic-release" target="_blank" class="external"><code>semantic-release</code></a> and a GitHub action to automatically release on NPM everything that gets merged to main.</p>
<p>The configuration for <code>semantic-release</code> is on <code>./releaserc</code> and the workflow for the release is on <code>./.github/workflow/release.yml</code>.</p>
<a id="md:testing" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Testing<a href="#md:testing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>I use <a href="https://jestjs.io" target="_blank" class="external">Jest</a> to test the project.</p>
<p>The configuration file is on <code>./.jestrc.js</code>, the tests are on <code>./tests</code> and the script that runs it is on <code>./utils/scripts/test</code>.</p>
<a id="md:code-linting-and-formatting" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Code linting and formatting<a href="#md:code-linting-and-formatting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For linting, I use <a href="https://eslint.org" target="_blank" class="external">ESlint</a> with <a href="https://npmjs.com/package/@homer0/eslint-plugin" target="_blank" class="external">my own custom configuration</a>.</p>
<p>There are two configuration files, <code>./.eslintrc</code> for the source and the tooling, and <code>./tests/.eslintrc</code>, and there's also a <code>./.eslintignore</code> to exclude some files.</p>
<p>For formatting, I use <a href="https://prettier.io" target="_blank" class="external">Prettier</a> with <a href="https://npmjs.com/package/@homer0/prettier-plugin-jsdoc" target="_blank" class="external">my JSDoc plugin</a> and <a href="https://npmjs.com/package/@homer0/prettier-config" target="_blank" class="external">my own custom configuration</a>. The configuration file is <code>./.prettierrc</code>.</p>
<p>The script that runs them is <code>./utils/scripts/lint</code>; the script <code>lint-all</code> only runs ESLint, and runs it for the entire project.</p>
<a id="md:documentation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Documentation<a href="#md:documentation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>I use <a href="https://typedoc.org" target="_blank" class="external">TypeDoc</a> to generate an HTML documentation site for the project.</p>
<p>The configuration file is <code>./.typedoc.json</code> and the script that runs it is on <code>./utils/scripts/docs</code>.</p>
<a id="md:👀-motivation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">👀 Motivation<a href="#md:👀-motivation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>A friend, who's also web developer, brought the idea of start using a dependency injection container on Node, and how Jimple was a great tool for it; from the moment I tried Jimple, I could never think of starting another project without it: It not only allows you to implement dependency injection on a simple and clean way, but it also kind of forces you to have a really good organization of your code.</p>
<p>A couple of months after that, the same friend told me that we should do something similar to <a href="https://github.com/silexphp/Silex" target="_blank" class="external">Silex</a>, which is based on Pimple, butwith Express. I ran with the idea and... this project is what I think a mix of Jimple and Express would look like. To be clear, <strong>this is not a port of Silex</strong>.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:jimpex"><span>Jimpex</span></a><ul><li><a href="#md:🍿-usage"><span>🍿 <wbr/>Usage</span></a></li><li><ul><li><a href="#md:🎨-creating-your-app"><span>🎨 <wbr/>Creating your app</span></a></li><li><a href="#md:🤖-boot"><span>🤖 <wbr/>Boot</span></a></li><li><a href="#md:⚙️-options-and-configuration"><span>⚙️ <wbr/>Options and configuration</span></a></li><li><ul><li><a href="#md:options"><span>Options</span></a></li><li><a href="#md:configuration"><span>Configuration</span></a></li></ul></li><li><a href="#md:🚀-starting-the-app"><span>🚀 <wbr/>Starting the app</span></a></li><li><a href="#md:✅-https"><span>✅ HTTPS</span></a></li><li><ul><li><a href="#md:http2"><span>HTTP2</span></a></li></ul></li><li><a href="#md:🛠-services"><span>🛠 <wbr/>Services</span></a></li><li><ul><li><ul><li><a href="#md:configurable-services"><span>Configurable services</span></a></li></ul></li></ul></li><li><a href="#md:🚦-controllers"><span>🚦 <wbr/>Controllers</span></a></li><li><ul><li><a href="#md:configurable-controllers"><span>Configurable controllers</span></a></li><li><a href="#md:controllers-with-services"><span>Controllers with services</span></a></li></ul></li><li><a href="#md:⚡️-middlewares"><span>⚡️ <wbr/>Middlewares</span></a></li><li><ul><li><a href="#md:configurable-middlewares"><span>Configurable middlewares</span></a></li><li><a href="#md:middlewares-with-services"><span>Middlewares with services</span></a></li></ul></li></ul></li><li><a href="#md:💪-typescript"><span>💪 <wbr/>Type<wbr/>Script</span></a></li><li><a href="#md:🤞-examples"><span>🤞 <wbr/>Examples</span></a></li><li><a href="#md:🤘-development"><span>🤘 <wbr/>Development</span></a></li><li><ul><li><a href="#md:npm-scripts"><span>NPM scripts</span></a></li><li><a href="#md:repository-hooks"><span>Repository hooks</span></a></li><li><a href="#md:commits-conventions"><span>Commits conventions</span></a></li><li><a href="#md:releases"><span>Releases</span></a></li><li><a href="#md:testing"><span>Testing</span></a></li><li><a href="#md:code-linting-and-formatting"><span>Code linting and formatting</span></a></li><li><a href="#md:documentation"><span>Documentation</span></a></li></ul></li><li><a href="#md:👀-motivation"><span>👀 <wbr/>Motivation</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>jimpex</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
